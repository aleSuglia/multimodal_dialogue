{% extends "main.html" %}

{% block includes %}
{% if accepted_hit %}
<meta id="namespace" data-name="{{namespace}}">
<script src="{{ url_for('static', filename='js/image_utils.js') }}"></script>
<script src="{{ url_for('static', filename='js/questioner.js') }}"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.5/socket.io.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/vex-js/2.3.4/js/vex.combined.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/vex-js/2.3.4/css/vex.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/vex-js/2.3.4/css/vex-theme-default.css" />
{% endif %}
{% endblock %}

{% block infobar %}
<div class="default navbar-fixed-top" id="info">
    <div class="container">
      <div class="row">
        <div class="col-sm-5">
          <div id ="info_text">
          </div>
          <div id="waiting">
            <div class="row">
              <div class="col-sm-1" id="w_time"></div>
              <div class="col-sm-10"><span class="loader"><span class="loader-inner"></span></span><span id="waiting_text"></span></div>
            </div>
          </div>
          <div id="question">
            <div class="row">
              <div class="col-sm-1" id="q_time"></div>
              <div class="col-sm-9"><input autocomplete="off" type="text" id="newquestion" placeholder="Ask a new question" class="form-control"></div>
              <div clas="col-sm-1"><a class="btn btn-success" id="ask" type="submit">Ask</a></div>
            </div>
          </div>
        </div>
        <div class="col-sm-5">
          <div id="guess">
            <a class="btn btn-primary" id="guessbtn">GuessWhat!</a>
          </div>
          <div id="object">
          </div>
        </div>
        <div class="col-sm-2">
          <div id="report"><a id="report_user" class="btn btn-danger">Report player</a>
          </div>
        </div>
      </div>
    </div>
 </div>
{% endblock %}

{% block body %}

<div class="container">
  <div class="row">
    <div class="col-sm-6" id="left">
      <div id="log"></div>
      <div id="intro" style="font-weight: 400">
        {% if namespace == '/q_questioner' %}
          <h3>Questioner game instructions</h3>
          <ul>
          <li>You will be shown an image of a scene with multiple objects. </li>
          <li>One of the objects will be assigned as the target (but not visible to you). </li>
          <li>Your job is to locate that object by asking yes or no questions.</li>
          <li>You click on the GuessWhat! button once you are <u>certain</u> which object it is. </li>
          <li>All object segmentations are then shown in the image, and you click on the correct object.</li>
          </ul>

          Please watch the instruction video on the right before starting your first game.
          <h3>Important</h3>
          <p>
          In this HIT we ask you to successfully complete 10 games. Your HIT will be approved if you <b>do not make more than 3 mistakes</b>. Because this is a live game, we consider it a <b>mistake when you disconnect from the server</b> while you are participating in a game.</p>.
          <p>
        {% else %}
        <h3>Questioner game instructions</h3>
          Instructions are the same as in the qualification HIT. See instruction video on the right for a quick recap. 
          <h3>Rewards</h3>
          <p>
          You can keep playing the game, and you will never need to submit this HIT. We will add a bonus to your qualification HIT for every game you successfully finish.  
          The exact reward depends on <b>your score in your last 10 games</b>:</p>
          <table class="table table-striped">
          <tr>
            <th>Number of successes</th>
            <th>Reward</th>
          </tr>
          <tr>
            <td>10</td><td>0.07</td>
          </tr>
          <tr>
            <td>9</td><td>0.06</td>
          </tr>
          <tr>
            <td>6-8</td><td>0.04</td>
          </tr>
          <tr>
            <td>0-5</td><td>0.0$</td>
          </tr>
          </table>
          </p>
          <p>Your reward will be automatically added as a bonus to your qualification HIT. </p>
        {% endif %}
        Do not hesitate to contact Harm de Vries - mail (at) harmdevries.com - if you have any further questions.</p>

      </div>
      {% if accepted_hit %}
      <p id="p_newgame"><span id="newgame_text"></span>
        <a class="btn btn-success" id="newgame" role="button">Start a new game &raquo;</a>
      </p>
      <form id="qualified" method="POST" action="{{turkSubmitTo}}/mturk/externalSubmit">
          Congratulations, you are now qualified to play Guesswhat?! Please submit your HIT below. 

          After that, search for GuessWhat?! HIT with [QUALIFIED ONLY] and keep playing the game! <br /><br />
          <input type="hidden" id="assignmentId" name="assignmentId" value="{{assignmentId}}" />
          <input type="hidden" name="test" value="test" />
          <input type="submit" class="btn btn-success" role="button" value="Submit HIT" />
      </form>
      {% endif %}
      
      
    </div>
    <div class="col-sm-6" id ="right">

      <img id="instructions" src="https://s3-us-west-2.amazonaws.com/guess-what/questioner_instructions.gif" style="margin-top: 25px; width: 100%" />
      
      <div style="position: relative;" id="image">
      <canvas id="img" width="100" height="100" 
       style="position: absolute; left: 0; top: 0; z-index: 0;"></canvas>
      <canvas id="segment" width="100" height="100" 
         style="position: absolute; left: 0; top: 0; z-index: 1;"></canvas>
      </div>
    </div>
  </div>
</div>
{% endblock %}